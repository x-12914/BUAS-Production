{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import'./PhoneNumberModal.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PhoneNumberModal=_ref=>{let{isOpen,onClose,onSave,initialPhoneNumbers=[],deviceId}=_ref;const[phoneInput,setPhoneInput]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');const userClearedInput=useRef(false);useEffect(()=>{if(isOpen){// Initialize with existing phone numbers only when modal opens\nsetPhoneInput(initialPhoneNumbers.join(', '));setError('');userClearedInput.current=false;// Reset the clear flag when modal opens\n}},[isOpen]);// Only depend on isOpen, not initialPhoneNumbers\n// Separate effect to handle phone numbers update when modal is already open\nuseEffect(()=>{if(isOpen&&initialPhoneNumbers.length>0&&!userClearedInput.current){// Only update if the input is empty and user hasn't manually cleared it\nif(!phoneInput.trim()){setPhoneInput(initialPhoneNumbers.join(', '));}}},[initialPhoneNumbers,isOpen]);const validatePhoneNumber=phone=>{// Remove all non-digit characters except + at the beginning\nconst cleaned=phone.replace(/[\\s\\-\\(\\)]/g,'');// Nigerian phone number patterns (priority)\nconst nigerianPatterns=[/^0[789][01]\\d{8}$/,// 08012345678, 07012345678, 09012345678\n/^234[789][01]\\d{8}$/,// 2348012345678, 2347012345678, 2349012345678\n/^\\+234[789][01]\\d{8}$/// +2348012345678, +2347012345678, +2349012345678\n];// Check Nigerian patterns first (priority)\nfor(const pattern of nigerianPatterns){if(pattern.test(cleaned)){return true;}}// International patterns (fallback) - but exclude numbers that start with 234 (Nigerian country code)\nif(!cleaned.startsWith('234')){const internationalPatterns=[/^\\+[1-9]\\d{6,14}$/,// +1234567890 (international with country code)\n/^[1-9]\\d{9,14}$/// 1234567890 (without country code, 10-15 digits total)\n];for(const pattern of internationalPatterns){if(pattern.test(cleaned)){return true;}}}return false;};const parsePhoneNumbers=input=>{return input.split(',').map(num=>num.trim()).filter(num=>num.length>0);};const handleSave=async()=>{setError('');// Allow empty input to remove all numbers\nconst phoneNumbers=phoneInput.trim()?parsePhoneNumbers(phoneInput):[];// Validate each phone number\nfor(const phone of phoneNumbers){if(!validatePhoneNumber(phone)){setError(\"Invalid phone number format: \".concat(phone,\". Nigerian formats: 08012345678, 2348012345678, +2348012345678. International: +1234567890\"));return;}}setLoading(true);try{await onSave(phoneNumbers);onClose();}catch(err){setError(err.message||'Failed to save phone numbers');}finally{setLoading(false);}};const handleClose=()=>{if(loading)return;setPhoneInput('');setError('');userClearedInput.current=false;// Reset the clear flag when closing\nonClose();};const handleClearAll=e=>{e.preventDefault();e.stopPropagation();setPhoneInput('');setError('');userClearedInput.current=true;// Mark that user manually cleared the input\n};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"phone-modal-overlay\",onClick:handleClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"phone-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"phone-modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCDE Phone Numbers\"}),/*#__PURE__*/_jsx(\"button\",{className:\"phone-modal-close-btn\",onClick:handleClose,disabled:loading,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"phone-modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"phone-input-section\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"phoneInput\",children:[\"Enter phone number(s) for device: \",/*#__PURE__*/_jsx(\"strong\",{children:deviceId})]}),/*#__PURE__*/_jsx(\"input\",{id:\"phoneInput\",type:\"text\",value:phoneInput,onChange:e=>setPhoneInput(e.target.value),placeholder:\"e.g., 08012345678, 2348012345678, +2348012345678\",className:\"phone-input-field\",disabled:loading,autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"phone-input-help\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83C\\uDDF3\\uD83C\\uDDEC \",/*#__PURE__*/_jsx(\"strong\",{children:\"Nigerian Phone Numbers:\"})]}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Local format: 08012345678, 07012345678, 09012345678\"}),/*#__PURE__*/_jsx(\"li\",{children:\"With country code: 2348012345678, 2347012345678\"}),/*#__PURE__*/_jsx(\"li\",{children:\"International format: +2348012345678, +2347012345678\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83C\\uDF0D \",/*#__PURE__*/_jsx(\"strong\",{children:\"International Numbers:\"})]}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"With country code: +1234567890, +44123456789\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Separate multiple numbers with commas\"})]})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"phone-modal-error\",children:/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u26A0\\uFE0F \",error]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"phone-modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleClose,disabled:loading,className:\"phone-modal-cancel-btn\",children:\"Cancel\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"phone-modal-right-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleClearAll,disabled:loading,className:\"phone-modal-clear-btn\",title:\"Clear all phone numbers\",children:\"\\uD83D\\uDDD1\\uFE0F Clear All\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,disabled:loading,className:\"phone-modal-save-btn\",children:loading?'Saving...':'Save Phone Numbers'})]})]})]})});};export default PhoneNumberModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}