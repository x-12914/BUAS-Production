{"ast":null,"code":"import _objectSpread from\"/home/opt/BUAS/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// Password Change Component for BUAS RBAC System\n// Following BUAS_RBAC_IMPLEMENTATION_GUIDE.md - Segment 3\nimport React,{useState,useEffect}from'react';import authService from'../services/authService';import'./PasswordChange.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PasswordChange=_ref=>{let{onPasswordChanged}=_ref;const[formData,setFormData]=useState({currentPassword:'',newPassword:'',confirmPassword:''});const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState('');const[passwordStrength,setPasswordStrength]=useState(null);const[requirements,setRequirements]=useState([]);const[showRequirements,setShowRequirements]=useState(false);// Load password requirements on component mount\nuseEffect(()=>{const loadRequirements=async()=>{const result=await authService.getPasswordRequirements();if(result.success){setRequirements(result.requirements);}};loadRequirements();},[]);// Check password strength when new password changes\nuseEffect(()=>{const checkStrength=async()=>{if(formData.newPassword.length>0){const user=authService.getCurrentUser();const result=await authService.checkPasswordStrength(formData.newPassword,(user===null||user===void 0?void 0:user.username)||'');if(result.success){setPasswordStrength(result);}}else{setPasswordStrength(null);}};const debounceTimer=setTimeout(checkStrength,300);return()=>clearTimeout(debounceTimer);},[formData.newPassword]);const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));// Clear error when user starts typing\nif(error){setError('');}};const handleSubmit=async e=>{e.preventDefault();// Validation\nif(!formData.currentPassword){setError('Please enter your current password');return;}if(!formData.newPassword){setError('Please enter a new password');return;}if(formData.newPassword!==formData.confirmPassword){setError('New passwords do not match');return;}if(passwordStrength&&!passwordStrength.valid){setError('Please choose a stronger password that meets all requirements');return;}setIsLoading(true);setError('');try{const result=await authService.changePassword(formData.currentPassword,formData.newPassword);if(result.success){onPasswordChanged();}else{setError(result.error||'Failed to change password');}}catch(error){setError('Network error. Please check your connection.');console.error('Password change error:',error);}finally{setIsLoading(false);}};const getPasswordStrengthIndicator=()=>{if(!passwordStrength||!formData.newPassword)return null;const strengthColors={'Weak':'#ef4444','Medium':'#f59e0b','Strong':'#10b981'};const strengthColor=strengthColors[passwordStrength.strength]||'#6b7280';return/*#__PURE__*/_jsxs(\"div\",{className:\"password-strength\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"strength-header\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Password Strength: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"strength-level\",style:{color:strengthColor},children:passwordStrength.strength}),/*#__PURE__*/_jsxs(\"span\",{className:\"strength-score\",children:[\"(\",passwordStrength.score,\"/100)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"strength-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"strength-fill\",style:{width:\"\".concat(passwordStrength.score,\"%\"),backgroundColor:strengthColor}})}),!passwordStrength.valid&&/*#__PURE__*/_jsx(\"div\",{className:\"strength-message error\",children:passwordStrength.message})]});};const getPasswordRequirements=()=>{if(!showRequirements||!requirements.length)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"password-requirements\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Password Requirements:\"}),/*#__PURE__*/_jsx(\"ul\",{children:requirements.map((requirement,index)=>/*#__PURE__*/_jsx(\"li\",{children:requirement},index))})]});};const user=authService.getCurrentUser();return/*#__PURE__*/_jsxs(\"div\",{className:\"password-change-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"password-change-background\",children:/*#__PURE__*/_jsx(\"div\",{className:\"background-pattern\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"password-change-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"password-change-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"change-icon\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"change-title\",children:\"Change Password\"}),/*#__PURE__*/_jsx(\"p\",{className:\"change-subtitle\",children:user!==null&&user!==void 0&&user.must_change_password?'You must change your password to continue':'Update your password for better security'})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"password-change-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"currentPassword\",children:\"Current Password\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"currentPassword\",name:\"currentPassword\",placeholder:\"Enter your current password\",value:formData.currentPassword,onChange:handleInputChange,required:true,className:\"password-input\",disabled:isLoading})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"newPassword\",children:[\"New Password\",/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"requirements-toggle\",onClick:()=>setShowRequirements(!showRequirements),children:[showRequirements?'Hide':'Show',\" Requirements\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"newPassword\",name:\"newPassword\",placeholder:\"Enter your new password\",value:formData.newPassword,onChange:handleInputChange,required:true,className:\"password-input\",disabled:isLoading})}),getPasswordStrengthIndicator(),getPasswordRequirements()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"confirmPassword\",children:\"Confirm New Password\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"confirmPassword\",name:\"confirmPassword\",placeholder:\"Confirm your new password\",value:formData.confirmPassword,onChange:handleInputChange,required:true,className:\"password-input\",disabled:isLoading})})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"password-error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{children:error})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"change-button \".concat(isLoading?'loading':''),disabled:isLoading||passwordStrength&&!passwordStrength.valid,children:isLoading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"loading-spinner\"}),\"Changing Password...\"]}):'Change Password'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"password-change-footer\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Your password will expire in 90 days\"})})]})]});};export default PasswordChange;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}