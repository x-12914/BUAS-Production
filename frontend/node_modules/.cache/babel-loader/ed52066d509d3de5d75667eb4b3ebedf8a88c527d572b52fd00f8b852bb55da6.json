{"ast":null,"code":"import _objectSpread from\"/home/opt/BUAS/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\n * User Modal Component\n * BUAS RBAC Implementation - Segment 6: User Management Frontend\n * \n * Modal for creating new users\n */import React,{useState,useEffect}from'react';import userService from'../services/userService';import authService from'../services/authService';import'./UserModal.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const UserModal=_ref=>{var _availableRoles$find;let{isOpen,onClose,onSubmit,title=\"Create New User\"}=_ref;const[formData,setFormData]=useState({username:'',role:''});const[availableRoles,setAvailableRoles]=useState([]);const[errors,setErrors]=useState({});const[loading,setLoading]=useState(false);const[usernameValidation,setUsernameValidation]=useState({valid:true,message:''});useEffect(()=>{if(isOpen){loadAvailableRoles();// Reset form when modal opens\nsetFormData({username:'',role:''});setErrors({});setUsernameValidation({valid:true,message:''});}},[isOpen]);const loadAvailableRoles=async()=>{try{const result=await userService.getAvailableRoles();if(result.success){setAvailableRoles(result.roles);// Auto-select first role if only one available\nif(result.roles.length===1){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{role:result.roles[0].value}));}}}catch(error){console.error('Failed to load available roles:',error);}};const handleInputChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));// Clear field error when user starts typing\nif(errors[field]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:''}));}// Validate username in real-time\nif(field==='username'){const validation=userService.validateUsername(value);setUsernameValidation(validation);}};const validateForm=()=>{const newErrors={};// Username validation\nif(!formData.username.trim()){newErrors.username='Username is required';}else if(!usernameValidation.valid){newErrors.username=usernameValidation.message;}// Role validation\nif(!formData.role){newErrors.role='Role is required';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}setLoading(true);try{await onSubmit(formData);}catch(error){console.error('Submit error:',error);}finally{setLoading(false);}};const handleClose=()=>{if(loading)return;// Prevent closing while submitting\nonClose();};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:handleClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:title}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close-btn\",onClick:handleClose,disabled:loading,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"user-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"username\",children:[\"Username \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"username\",type:\"text\",value:formData.username,onChange:e=>handleInputChange('username',e.target.value),placeholder:\"Enter username\",disabled:loading,className:errors.username?'error':''}),errors.username&&/*#__PURE__*/_jsx(\"div\",{className:\"field-error\",children:errors.username}),formData.username&&!usernameValidation.valid&&/*#__PURE__*/_jsx(\"div\",{className:\"field-warning\",children:usernameValidation.message}),formData.username&&usernameValidation.valid&&usernameValidation.message&&/*#__PURE__*/_jsx(\"div\",{className:\"field-success\",children:usernameValidation.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"role\",children:[\"Role \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"role\",value:formData.role,onChange:e=>handleInputChange('role',e.target.value),disabled:loading,className:errors.role?'error':'',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a role\"}),availableRoles.map(role=>/*#__PURE__*/_jsx(\"option\",{value:role.value,children:role.label},role.value))]}),errors.role&&/*#__PURE__*/_jsx(\"div\",{className:\"field-error\",children:errors.role}),formData.role&&/*#__PURE__*/_jsx(\"div\",{className:\"role-description\",children:(_availableRoles$find=availableRoles.find(r=>r.value===formData.role))===null||_availableRoles$find===void 0?void 0:_availableRoles$find.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"password-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Password Information\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"A temporary password will be generated automatically\"}),/*#__PURE__*/_jsx(\"li\",{children:\"The user must change their password on first login\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Communicate the temporary password securely to the user\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:handleClose,disabled:loading,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading||!usernameValidation.valid,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner\"}),\"Creating...\"]}):'Create User'})]})]})]})});};export default UserModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}